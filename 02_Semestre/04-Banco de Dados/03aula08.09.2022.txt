SELECT p.id, p.descricao, (SELECT COUNT(*) /*esse select pega as ocorências de venda de cada id*/
									FROM item i
									WHERE i.idproduto = p.id ) AS Ocorrência,
									(SELECT SUM(i.quantidade) /*esse select pega as quantidades vendidas de cada id*/
									FROM item i
									WHERE i.idproduto = p.id ) AS Qtde_Vendidas,
									(SELECT SUM(i.quantidade*i.precounitario) /*esse select pega o valor vendido de cada id*/
									FROM item i
									WHERE i.idproduto = p.id ) AS Valor
FROM produto p

/*mesmo código com join*/
SELECT p.id, p.descricao, COUNT(i.idproduto) AS Ocorrência,  
	SUM(i.quantidade) AS Quantidade,
	SUM(i.quantidade*i.precounitario) AS Valor_Total
FROM produto p, item i
WHERE i.idproduto = p.id
GROUP BY 1,2

/*o select vira como se fosse uma tabela */
SELECT c2.nome
FROM (SELECT c.id, c.nome, c.municipio
		FROM cliente c
		WHERE c.estado = 'SP') AS c2
WHERE c2.municipio = "ITAPIRA"

SELECT idcliente, c.nome, SUM(quantidade * precounitario) AS total 
FROM(SELECT p.idcliente, p.datemissao, p.idformapagto,
		i.idproduto, i.quantidade, i.precounitario
		FROM item i, pedido p
		WHERE i.idpedido = p.id) AS t, cliente c
WHERE c.id = t.idcliente
GROUP BY 1

/*por forma de pagamento*/
SELECT idformapagto, f.descricao, SUM(quantidade * precounitario) AS total 
FROM(SELECT p.idcliente, p.datemissao, p.idformapagto,
		i.idproduto, i.quantidade, i.precounitario
		FROM item i, pedido p, 
		WHERE i.idpedido = p.id) AS t, formapagto  f 
WHERE f.id = t.idformapagto
GROUP BY 1

/*por produto*/
SELECT idproduto, p2.descricao , SUM(quantidade * precounitario) AS total 
FROM(SELECT p.idcliente, p.datemissao, p.idformapagto,
		i.idproduto, i.quantidade, i.precounitario
		FROM item i, pedido p
		WHERE i.idpedido = p.id) AS t, produto p2 
WHERE p2.id = t.idproduto
GROUP BY 1

--------------------------------------------------------------------------------------------------------------------------

CASE:

ALTER TABLE cliente
ADD tipo CHAR(1);

UPDATE cliente
SET tipo = "J";

UPDATE cliente
SET tipo = "F"
WHERE id = 7

INSERT INTO cliente
VALUES(7,"JOSE VANTUAN","Rua 8","27","","CENTRO",
"ARARAS","13600-000","SP","",1,1,"F")

INSERT INTO cliente
VALUES(8,"AGOSTINHO DE HIPONA","RUA CONFISSOES","430","","CENTRO",
"RIO CLARO","13506-000","SP","",2,1,"F")

SELECT NOME, MUNICIPIO,
	CASE
		WHEN TIPO="J" THEN "PESSOA JURIDICA"
		WHEN TIPO="F" THEN "PESSOA FISICA"
	END AS TIPO
FROM CLIENTE 

